{
    "componentChunkName": "component---src-templates-tutorial-js",
    "path": "/se/developers/tutorials/transfers-and-approval-of-erc-20-tokens-from-a-solidity-smart-contract/",
    "result": {"data":{"siteData":{"siteMetadata":{"editContentUrl":"https://github.com/ethereum/ethereum-org-website/tree/dev/"}},"pageData":{"fields":{"slug":"/en/developers/tutorials/transfers-and-approval-of-erc-20-tokens-from-a-solidity-smart-contract/","readingTime":{"minutes":6.76}},"frontmatter":{"title":"Transfers and approval of ERC-20 tokens from a solidity smart contract","description":"How to use a smart contract to interact with a token using the Solidity language","lang":"en","tags":["smart contracts","tokens","solidity","getting started","erc-20"],"author":"jdourlens","source":"EthereumDev","sourceUrl":"https://ethereumdev.io/transfers-and-approval-or-erc20-tokens-from-a-solidity-smart-contract/","skill":"intermediate","published":"2020-04-07T00:00:00.000Z","sidebar":true,"sidebarDepth":null,"address":"0x19dE91Af973F404EDF5B4c093983a7c6E3EC8ccE","isOutdated":null},"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Transfers and approval of ERC-20 tokens from a solidity smart contract\",\n  \"description\": \"How to use a smart contract to interact with a token using the Solidity language\",\n  \"author\": \"jdourlens\",\n  \"tags\": [\"smart contracts\", \"tokens\", \"solidity\", \"getting started\", \"erc-20\"],\n  \"skill\": \"intermediate\",\n  \"lang\": \"en\",\n  \"sidebar\": true,\n  \"published\": \"2020-04-07T00:00:00.000Z\",\n  \"source\": \"EthereumDev\",\n  \"sourceUrl\": \"https://ethereumdev.io/transfers-and-approval-or-erc20-tokens-from-a-solidity-smart-contract/\",\n  \"address\": \"0x19dE91Af973F404EDF5B4c093983a7c6E3EC8ccE\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar Divider = makeShortcode(\"Divider\");\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"In the previous tutorial we studied \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/developers/tutorials/understand-the-erc-20-token-smart-contract/\"\n  }, \"the anatomy of an ERC-20 token in Solidity\"), \" on the Ethereum blockchain. In this article we\\u2019ll see how we can use a smart contract to interact with a token using the Solidity language.\"), mdx(\"p\", null, \"For this smart contract, we\\u2019ll create a really dummy decentralized exchange where a user can trade Ethereum with our newly deployed \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/developers/docs/standards/tokens/erc-20/\"\n  }, \"ERC-20 token\"), \".\"), mdx(\"p\", null, \"For this tutorial we\\u2019ll use the code we wrote in the previous tutorial as a base. Our DEX will instantiate an instance of the contract in its constructor and perform the operations of:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"exchanging tokens to ether\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"exchanging ether to tokens\")), mdx(\"p\", null, \"We\\u2019ll start our Decentralized exchange code by adding our simple ERC20 codebase:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"pragma solidity ^0.6.0;\\n\\ninterface IERC20 {\\n\\n    function totalSupply() external view returns (uint256);\\n    function balanceOf(address account) external view returns (uint256);\\n    function allowance(address owner, address spender) external view returns (uint256);\\n\\n    function transfer(address recipient, uint256 amount) external returns (bool);\\n    function approve(address spender, uint256 amount) external returns (bool);\\n    function transferFrom(address sender, address recipient, uint256 amount) external returns (bool);\\n\\n\\n    event Transfer(address indexed from, address indexed to, uint256 value);\\n    event Approval(address indexed owner, address indexed spender, uint256 value);\\n}\\n\\n\\ncontract ERC20Basic is IERC20 {\\n\\n    string public constant name = \\\"ERC20Basic\\\";\\n    string public constant symbol = \\\"ERC\\\";\\n    uint8 public constant decimals = 18;\\n\\n\\n    event Approval(address indexed tokenOwner, address indexed spender, uint tokens);\\n    event Transfer(address indexed from, address indexed to, uint tokens);\\n\\n\\n    mapping(address => uint256) balances;\\n\\n    mapping(address => mapping (address => uint256)) allowed;\\n\\n    uint256 totalSupply_ = 100 ether;\\n\\n    using SafeMath for uint256;\\n\\n   constructor(uint256 total) public {\\n    balances[msg.sender] = totalSupply_;\\n    }\\n\\n    function totalSupply() public override view returns (uint256) {\\n    return totalSupply_;\\n    }\\n\\n    function balanceOf(address tokenOwner) public override view returns (uint256) {\\n        return balances[tokenOwner];\\n    }\\n\\n    function transfer(address receiver, uint256 numTokens) public override returns (bool) {\\n        require(numTokens <= balances[msg.sender]);\\n        balances[msg.sender] = balances[msg.sender].sub(numTokens);\\n        balances[receiver] = balances[receiver].add(numTokens);\\n        emit Transfer(msg.sender, receiver, numTokens);\\n        return true;\\n    }\\n\\n    function approve(address delegate, uint256 numTokens) public override returns (bool) {\\n        allowed[msg.sender][delegate] = numTokens;\\n        emit Approval(msg.sender, delegate, numTokens);\\n        return true;\\n    }\\n\\n    function allowance(address owner, address delegate) public override view returns (uint) {\\n        return allowed[owner][delegate];\\n    }\\n\\n    function transferFrom(address owner, address buyer, uint256 numTokens) public override returns (bool) {\\n        require(numTokens <= balances[owner]);\\n        require(numTokens <= allowed[owner][msg.sender]);\\n\\n        balances[owner] = balances[owner].sub(numTokens);\\n        allowed[owner][msg.sender] = allowed[owner][msg.sender].sub(numTokens);\\n        balances[buyer] = balances[buyer].add(numTokens);\\n        emit Transfer(owner, buyer, numTokens);\\n        return true;\\n    }\\n}\\n\\nlibrary SafeMath {\\n    function sub(uint256 a, uint256 b) internal pure returns (uint256) {\\n      assert(b <= a);\\n      return a - b;\\n    }\\n\\n    function add(uint256 a, uint256 b) internal pure returns (uint256) {\\n      uint256 c = a + b;\\n      assert(c >= a);\\n      return c;\\n    }\\n}\\n\")), mdx(\"p\", null, \"Our new DEX smart contract will deploy the ERC-20 and get all the supplied:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"contract DEX {\\n\\n    IERC20 public token;\\n\\n    event Bought(uint256 amount);\\n    event Sold(uint256 amount);\\n\\n    constructor() public {\\n        token = new ERC20Basic();\\n    }\\n\\n    function buy() payable public {\\n        // TODO\\n    }\\n\\n    function sell(uint256 amount) public {\\n        // TODO\\n    }\\n\\n}\\n\")), mdx(\"p\", null, \"So we now have our DEX and it has all the token reserve available. The contract has two functions:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"buy\"), \": The user can send ether and get tokens in exchange\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"sell\"), \": The user can decide to send tokens to get ether back\")), mdx(\"h2\", {\n    \"id\": \"the-buy-function\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#the-buy-function\",\n    \"aria-label\": \"the buy function permalink\",\n    \"className\": \"header-anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"The buy function\"), mdx(\"p\", null, \"Let\\u2019s code the buy function. We\\u2019ll first need to check the amount of ether the message contains and verify that the contracts own enough tokens and that the message has some ether in it. If the contract owns enough tokens it\\u2019ll send the number of tokens to the user and emit the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Bought\"), \" event.\"), mdx(\"p\", null, \"Note that if we call the require function in the case of an error the ether sent will directly be reverted and given back to the user.\"), mdx(\"p\", null, \"To keep things simple, we just exchange 1 token for 1 Wei.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"function buy() payable public {\\n    uint256 amountTobuy = msg.value;\\n    uint256 dexBalance = token.balanceOf(address(this));\\n    require(amountTobuy > 0, \\\"You need to send some ether\\\");\\n    require(amountTobuy <= dexBalance, \\\"Not enough tokens in the reserve\\\");\\n    token.transfer(msg.sender, amountTobuy);\\n    emit Bought(amountTobuy);\\n}\\n\")), mdx(\"p\", null, \"In the case where the buy is successful we should see two events in the transaction: The token \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Transfer\"), \" and the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Bought\"), \" event.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1178px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/0789b512ac67511f04564aed1d2d3378/a13c9/transfer-and-bought-events.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"52.33333333333333%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA6UlEQVQoz4WS2w6CMBBE+f+vU5+MSkWgLb1Ab1xeHdkEVIgmQ5OSzp7daTNtbUxpGMcvjdNUc54zdi8ej7KEtDE+hNT3y5lMSOm83zVzIRqlcDqmCACpH4bVXFYV6uHo1iybhkq7EF6r951z8Z1ccd46tzVD8GAFamaCD27/QX7fbAWDEBJTV3WNCPApY9quo0mzH06SD/6W54fj6Xy53hhDlZX8w0ZNhZgwOaIB2bZtN89IY/4xhxjRp5CNMVYbq7Sm5PD/Zd6NagkcUtqwokDD4MOEFHE79DSy3RdCTgQDAQLRJVO5hfcEorI2ANOIwmkAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Two events in the transaction: Transfer and Bought\",\n    \"title\": \"Two events in the transaction: Transfer and Bought\",\n    \"src\": \"/static/0789b512ac67511f04564aed1d2d3378/a13c9/transfer-and-bought-events.png\",\n    \"srcSet\": [\"/static/0789b512ac67511f04564aed1d2d3378/5a46d/transfer-and-bought-events.png 300w\", \"/static/0789b512ac67511f04564aed1d2d3378/0a47e/transfer-and-bought-events.png 600w\", \"/static/0789b512ac67511f04564aed1d2d3378/a13c9/transfer-and-bought-events.png 1178w\"],\n    \"sizes\": \"(max-width: 1178px) 100vw, 1178px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"h2\", {\n    \"id\": \"the-sell-function\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#the-sell-function\",\n    \"aria-label\": \"the sell function permalink\",\n    \"className\": \"header-anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"The sell function\"), mdx(\"p\", null, \"The function responsible for the sell will first require the user to have approved the amount by calling the approve function beforehand. Then when the sell function is called, we\\u2019ll check if the transfer from the caller address to the contract address was successful and then send the Ethers back to the caller address.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"function sell(uint256 amount) public {\\n    require(amount > 0, \\\"You need to sell at least some tokens\\\");\\n    uint256 allowance = token.allowance(msg.sender, address(this));\\n    require(allowance >= amount, \\\"Check the token allowance\\\");\\n    token.transferFrom(msg.sender, address(this), amount);\\n    msg.sender.transfer(amount);\\n    emit Sold(amount);\\n}\\n\")), mdx(\"p\", null, \"If everything works you should see 2 events (a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Transfer\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Sold\"), \") in the transaction and your token balance and Ethereum balance updated.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1138px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/974fb2c5796514cc8789bc9e75560e67/05fb0/transfer-and-sold-events.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"49.66666666666666%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA8ElEQVQoz4WR226DMBBE+f/fa/vUBLAJ4Lu5w2OO6yqq0ohYI4TWOzuz46IWYpymdduesO27dY5b63wcBh+C9Z5viMOyrrmn4G5elv9kQJ1ubYyxLg7jNM9U/jYXzvuXyoA6BHQARvbjSNgP/kEihxgfNp6V13QwqoxRWimtgbEWCo6YW+QZJ3A+yKb5vlzLqrqUZVULmJhHsjhnrim4/da2H59f16oSUoqm8SHiP9k+Z+aEyAWrZD6M6VDJWbxX7pVCsJby1nZd3/daM4ld3uy8/ASGDjl1SvFEuM1R/6aNk5dMrvGJ29yXl8zP9ui5A2XwN2uPWaYDAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Two events in the transaction: Transfer and Sold\",\n    \"title\": \"Two events in the transaction: Transfer and Sold\",\n    \"src\": \"/static/974fb2c5796514cc8789bc9e75560e67/05fb0/transfer-and-sold-events.png\",\n    \"srcSet\": [\"/static/974fb2c5796514cc8789bc9e75560e67/5a46d/transfer-and-sold-events.png 300w\", \"/static/974fb2c5796514cc8789bc9e75560e67/0a47e/transfer-and-sold-events.png 600w\", \"/static/974fb2c5796514cc8789bc9e75560e67/05fb0/transfer-and-sold-events.png 1138w\"],\n    \"sizes\": \"(max-width: 1138px) 100vw, 1138px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(Divider, {\n    mdxType: \"Divider\"\n  }), mdx(\"p\", null, \"From this tutorial we saw how to check the balance and allowance of an ERC-20 token and also how to call \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Transfer\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"TransferFrom\"), \" of an ERC20 smart contract using the interface.\"), mdx(\"p\", null, \"Once you make a transaction we have a Javascript tutorial to \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://ethereumdev.io/waiting-for-a-transaction-to-be-mined-on-ethereum-with-js/\"\n  }, \"wait and get details about the transactions\"), \" that were made to your contract and a \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://ethereumdev.io/how-to-decode-event-logs-in-javascript-using-abi-decoder/\"\n  }, \"tutorial to decode events generated by token transfers or any other events\"), \" as long as you have the ABI.\"), mdx(\"p\", null, \"Here is the complete code for the tutorial:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"pragma solidity ^0.6.0;\\n\\ninterface IERC20 {\\n\\n    function totalSupply() external view returns (uint256);\\n    function balanceOf(address account) external view returns (uint256);\\n    function allowance(address owner, address spender) external view returns (uint256);\\n\\n    function transfer(address recipient, uint256 amount) external returns (bool);\\n    function approve(address spender, uint256 amount) external returns (bool);\\n    function transferFrom(address sender, address recipient, uint256 amount) external returns (bool);\\n\\n\\n    event Transfer(address indexed from, address indexed to, uint256 value);\\n    event Approval(address indexed owner, address indexed spender, uint256 value);\\n}\\n\\n\\ncontract ERC20Basic is IERC20 {\\n\\n    string public constant name = \\\"ERC20Basic\\\";\\n    string public constant symbol = \\\"ERC\\\";\\n    uint8 public constant decimals = 18;\\n\\n\\n    event Approval(address indexed tokenOwner, address indexed spender, uint tokens);\\n    event Transfer(address indexed from, address indexed to, uint tokens);\\n\\n\\n    mapping(address => uint256) balances;\\n\\n    mapping(address => mapping (address => uint256)) allowed;\\n\\n    uint256 totalSupply_ = 10 ether;\\n\\n    using SafeMath for uint256;\\n\\n   constructor() public {\\n    balances[msg.sender] = totalSupply_;\\n    }\\n\\n    function totalSupply() public override view returns (uint256) {\\n    return totalSupply_;\\n    }\\n\\n    function balanceOf(address tokenOwner) public override view returns (uint256) {\\n        return balances[tokenOwner];\\n    }\\n\\n    function transfer(address receiver, uint256 numTokens) public override returns (bool) {\\n        require(numTokens <= balances[msg.sender]);\\n        balances[msg.sender] = balances[msg.sender].sub(numTokens);\\n        balances[receiver] = balances[receiver].add(numTokens);\\n        emit Transfer(msg.sender, receiver, numTokens);\\n        return true;\\n    }\\n\\n    function approve(address delegate, uint256 numTokens) public override returns (bool) {\\n        allowed[msg.sender][delegate] = numTokens;\\n        emit Approval(msg.sender, delegate, numTokens);\\n        return true;\\n    }\\n\\n    function allowance(address owner, address delegate) public override view returns (uint) {\\n        return allowed[owner][delegate];\\n    }\\n\\n    function transferFrom(address owner, address buyer, uint256 numTokens) public override returns (bool) {\\n        require(numTokens <= balances[owner]);\\n        require(numTokens <= allowed[owner][msg.sender]);\\n\\n        balances[owner] = balances[owner].sub(numTokens);\\n        allowed[owner][msg.sender] = allowed[owner][msg.sender].sub(numTokens);\\n        balances[buyer] = balances[buyer].add(numTokens);\\n        emit Transfer(owner, buyer, numTokens);\\n        return true;\\n    }\\n}\\n\\nlibrary SafeMath {\\n    function sub(uint256 a, uint256 b) internal pure returns (uint256) {\\n      assert(b <= a);\\n      return a - b;\\n    }\\n\\n    function add(uint256 a, uint256 b) internal pure returns (uint256) {\\n      uint256 c = a + b;\\n      assert(c >= a);\\n      return c;\\n    }\\n}\\n\\ncontract DEX {\\n\\n    event Bought(uint256 amount);\\n    event Sold(uint256 amount);\\n\\n\\n    IERC20 public token;\\n\\n    constructor() public {\\n        token = new ERC20Basic();\\n    }\\n\\n    function buy() payable public {\\n        uint256 amountTobuy = msg.value;\\n        uint256 dexBalance = token.balanceOf(address(this));\\n        require(amountTobuy > 0, \\\"You need to send some ether\\\");\\n        require(amountTobuy <= dexBalance, \\\"Not enough tokens in the reserve\\\");\\n        token.transfer(msg.sender, amountTobuy);\\n        emit Bought(amountTobuy);\\n    }\\n\\n    function sell(uint256 amount) public {\\n        require(amount > 0, \\\"You need to sell at least some tokens\\\");\\n        uint256 allowance = token.allowance(msg.sender, address(this));\\n        require(allowance >= amount, \\\"Check the token allowance\\\");\\n        token.transferFrom(msg.sender, address(this), amount);\\n        msg.sender.transfer(amount);\\n        emit Sold(amount);\\n    }\\n\\n}\\n\")));\n}\n;\nMDXContent.isMDXComponent = true;","tableOfContents":{"items":[{"url":"#the-buy-function-the-buy-function","title":"The buy function {#the-buy-function}"},{"url":"#the-sell-function-the-sell-function","title":"The sell function {#the-sell-function}"}]}}},"pageContext":{"slug":"/se/developers/tutorials/transfers-and-approval-of-erc-20-tokens-from-a-solidity-smart-contract/","ignoreTranslationBanner":false,"isOutdated":false,"isContentEnglish":true,"relativePath":"src/content/developers/tutorials/transfers-and-approval-of-erc-20-tokens-from-a-solidity-smart-contract/index.md","intl":{"language":"se","defaultLanguage":"en","languages":["en","ar","bg","bn","ca","cs","de","el","es","fa","fi","fr","hi","hr","hu","id","ig","it","ja","ko","lt","ml","nl","nb","pl","pt","pt-br","ro","ru","se","sk","sl","tr","uk","vi","zh","zh-tw"],"messages":{"page-developer-meta-title":"Ethereum utvecklarresurser","page-developers-about":"Om dessa utvecklarresurser","page-developers-about-desc":"ethereum.org är här för att hjälpa dig skapa med Ethereum, med dokumentation om grundläggande begrepp såväl som utvecklingsstacken. Dessutom finns det handledningar för att hjälpa dig komma igång.","page-developers-about-desc-2":"Inspirerad av Mozillas Developer Network tyckte vi att Ethereum behövde en plats för att rymma bra innehåll och resurser. Liksom hos våra vänner på Mozilla är allt här öppen källkod, redo för dig att utöka och förbättra.","page-developers-account-desc":"Kontrakt eller personer i nätverket","page-developers-accounts-link":"Konton","page-developers-advanced":"Avancerat","page-developers-api-desc":"Använda bibliotek för att interagera med smarta kontrakt","page-developers-api-link":"Serverdel-API:er","page-developers-aria-label":"Utvecklarmeny","page-developers-block-desc":"Batcher av transaktioner som lagts till i blockkedjan","page-developers-block-explorers-desc":"Din portal till Ethereum-data","page-developers-block-explorers-link":"Blockutforskare","page-developers-blocks-link":"Block","page-developers-browse-tutorials":"Bläddra i handledningar","page-developers-choose-stack":"Välj din stack","page-developers-contribute":"Bidra","page-developers-dev-env-desc":"IDE:er som är lämpliga för dapp-utveckling","page-developers-dev-env-link":"Utvecklingsmiljöer","page-developers-discord":"Gå med i Discord","page-developers-docs-introductions":"Introduktioner","page-developers-evm-desc":"Datorn som bearbetar transaktioner","page-developers-evm-link":"Den virtuella Ethereum-maskinen (EVM)","page-developers-explore-documentation":"Utforska dokumentationen","page-developers-feedback":"Om du har någon feedback kan du kontakta oss via ett GitHub-problem eller via vår Discord-server.","page-developers-frameworks-desc":"Verktyg för att hjälpa till att påskynda utvecklingen","page-developers-frameworks-link":"Ramverk för utveckling","page-developers-fundamentals":"Grundläggande principer","page-developers-gas-desc":"Ether behövs för att driva transaktioner","page-developers-gas-link":"Bränsle","page-developers-get-started":"Hur vill du komma igång?","page-developers-improve-ethereum":"Hjälp oss att göra ethereum.org bättre","page-developers-improve-ethereum-desc":"Precis som ethereum.org är dessa dokument är en gemensam ansträngning. Skapa en PR om du hittar misstag, utrymme för förbättring, eller nya möjligheter att hjälpa Ethereum-utvecklare.","page-developers-into-eth-desc":"En introduktion till blockchain och Ethereum","page-developers-intro-dapps-desc":"En introduktion till decentraliserade program","page-developers-intro-dapps-link":"Introduktion till dapps","page-developers-intro-eth-link":"Introduktion till Ethereum","page-developers-intro-stack":"Introduktion till stacken","page-developers-intro-stack-desc":"En introduktion till Ethereum-stacken","page-developers-js-libraries-desc":"Använda javascript för att interagera med smarta kontrakt","page-developers-js-libraries-link":"Javascript-bibliotek","page-developers-language-desc":"Använda Ethereum med välkända språk","page-developers-languages":"Programmeringsspråk","page-developers-learn":"Lär dig Ethereum-utveckling","page-developers-learn-desc":"Läs mer om kärnkoncepten och Ethereum-stacken i våra dokument","page-developers-learn-tutorials":"Lär dig genom självstudier","page-developers-learn-tutorials-cta":"Visa handledningar","page-developers-learn-tutorials-desc":"Lär dig Ethereum-utveckling steg för steg från utvecklare som redan har gjort det.","page-developers-meta-desc":"Dokumentation, handledningar och verktyg för utvecklare som bygger på Ethereum.","page-developers-mining-desc":"Hur nya block skapas och samstämmighet uppnås","page-developers-mining-link":"Utvinning","page-developers-networks-desc":"En översikt över Mainnet och testnätverken","page-developers-networks-link":"Nätverk","page-developers-node-clients-desc":"Hur block och transaktioner verifieras i nätverket","page-developers-node-clients-link":" Noder och klienter","page-developers-oracle-desc":"Få off-chain-data till dina smarta kontrakt","page-developers-oracles-link":"Orakel","page-developers-play-code":"Lek med koder","page-developers-read-docs":"Läs dokumenten","page-developers-scaling-desc":"Lösningar för snabbare transaktioner","page-developers-scaling-link":"Skalning","page-developers-smart-contract-security-desc":"Säkerhetsåtgärder att beakta vid utveckling","page-developers-smart-contract-security-link":"Säkerhet","page-developers-set-up":"Konfigurera lokal miljö","page-developers-setup-desc":"Förbered stacken för utveckling genom att skapa en utvecklingsmiljö.","page-developers-smart-contracts-desc":"Logiken bakom dapps – självverkande avtal","page-developers-smart-contracts-link":"Smarta kontrakt","page-developers-stack":"Stacken","page-developers-start":"Börja experimentera","page-developers-start-desc":"Vill du experimentera först och ställa frågor senare?","page-developers-storage-desc":"Hur du hanterar dapp-lagring","page-developers-storage-link":"Lagring","page-developers-subtitle":"En bygghandbok för Ethereum. Av byggare, för byggare.","page-developers-title-1":"Ethereum","page-developers-title-2":"utvecklare","page-developers-title-3":"resurser","page-developers-token-standards-desc":"En översikt över accepterade tokenstandarder","page-developers-token-standards-link":"Tokenstandarder","page-developers-transactions-desc":"Hur Ethereum-tillstånd förändras","page-developers-transactions-link":"Transaktioner","page-developers-web3-desc":"Hur web3-utvecklingsvärlden är annorlunda","page-developers-web3-link":"Web2 kontra Web3","page-index-hero-image-alt":"ethereum.org bild av hjälte","page-index-meta-description":"Ethereum är en global, decentraliserad plattform för pengar och nya slags applikationer. På Ethereum kan du skriva kod som styr pengar och bygga appar som är tillgängliga var som helst i världen.","page-index-meta-title":"Startsida","page-index-sections-developers-desc":"Lär dig mer om tekniken bakom Ethereum och dess appar så att du kan börja skapa med den.","page-index-sections-developers-image-alt":"Illustration av en hand som bygger en Ethereum-glyf gjord av lego-tegel","page-index-sections-developers-link-text":"Börja skapa","page-index-sections-developers-title":"Utvecklare","page-index-sections-enterprise-desc":"Se hur Ethereum kan öppna nya affärsmodeller, minska dina kostnader och framtidssäkra din verksamhet.","page-index-sections-enterprise-image-alt":"Illustration av en grupp som arbetar med ett Ethereum-projekt runt en bärbar dator","page-index-sections-enterprise-link-text":"Ethereum för storföretag","page-index-sections-enterprise-title":"Enterprise","page-index-sections-individuals-desc":"Lär känna Ethereum, Ether, plånböcker, token och mer så att du kan börja använda Ethereum-appar.","page-index-sections-individuals-image-alt":"Illustration av hund som sitter vid en dator","page-index-sections-individuals-link-text":"Kom igång med Ethereum","page-index-sections-individuals-title":"Om Ethereum","page-index-subtitle":"På Ethereum kan du skriva kod som styr digitalt värde, körs exakt som programmerat och är tillgängligt var som helst i världen.","page-index-title":"Ethereum är en global plattform med öppen källkod för decentraliserade appar.","about-ethereum-org":"Om ethereum.org","about-us":"Om oss","brand-assets":"Varumärkestillgångar","community":"Community","contact":"Kontakta oss","contributing":"Bidragande","cookie-policy":"Cookie-policy","decentralized-applications-dapps":"Decentraliserade program (dapps)","developers":"Utvecklare","developers-home":"Startsida för utvecklare","documentation":"Dokumentation","ef-blog":"Ethereum Foundation-blogg","eips":"Förbättringsförslag för Ethereum","enterprise":"Enterprise","ethereum":"Ethereum","ethereum-2-0":"Ethereum 2.0","ethereum-brand-assets":"Ethereum varumärkestillgångar","ethereum-community":"Ethereum Community","ethereum-glossary":"Ethereum-ordlista","ethereum-wallets":"Ethereum-plånböcker","ethereum-whitepaper":"Ethereum-vitbok","get-eth":"Skaffa ETH","get-started":"Kom igång","guides-and-resources":"Guider och resurser","how-ethereum-works":"Hur Ethereum fungerar","individuals":"Privatpersoner","language-support":"Språksupport","languages":"Språk","learn":"Lär dig","learn-by-coding":"Lär dig genom kodning","learn-more":"Lär dig mer","mainnet-ethereum":"Mainnet Ethereum","nav-beginners":"Nybörjare","page-404-copy":"Använd sökrutan ovan för att hitta det du letar efter eller återvända hem.","page-404-not-found":"Hittades inte","page-enterprise":"Enterprise","page-index":"Ethereum","page-index-section-beginners-item-one":"Helt ny på Ethereum?","page-index-section-beginners-item-three":"Varför ska jag bry mig?","page-index-section-beginners-item-two":"Vad är Ethereum?","page-index-section-beginners-title":"Nybörjare","page-index-section-developers-item-one":"Komma igång-guider","page-index-section-developers-item-three":"Senaste utvecklarverktyg","page-index-section-developers-item-two":"Lär dig att programmera smarta kontrakt","page-index-section-developers-title":"För utvecklare","page-index-section-enterprise-item-one":"Varför Enterprise Ethereum?","page-index-section-enterprise-item-three":"Enterprise utvecklargemenskap","page-index-section-enterprise-item-two":"Enterprise-funktioner","page-index-section-enterprise-title":"För Enterprise","page-index-section-individuals-item-one":"Vad är Ethereum?","page-index-section-individuals-item-three":"Guider och resurser","page-index-section-individuals-item-two":"Använda Ethereum","page-index-section-individuals-title":"För privatpersoner","page-index-section-learn-item-one":"Nybörjarresurser","page-index-section-learn-item-three":"ETH 2.0","page-index-section-use-item-one":"Vad kan jag göra med Ethereum idag?","page-index-section-use-item-three":"Vad är en plånbok?","page-index-section-use-item-two":"Hur får jag tag i ether?","page-index-section-use-title":"Använd","page-last-updated":"Sidan uppdaterades senast","page-learning-tools-consensys-academy-description":"Online-bootcamp för Ethereum-utvecklare","page-learning-tools-cryptozombies-description":"Lär dig Solidity genom att skapa ditt eget Zombie-spel","page-learning-tools-ethernauts-description":"Hacka smarta kontrakt för att komma upp till nästa nivå","privacy-policy":"Sekretesspolicy","private-ethereum":"Privat Ethereum","search":"Sök","set-up-local-env":"Konfigurera lokal miljö","stablecoins":"Stablecoins","terms-of-use":"Användarvillkor","translation-banner-body-new":"Du tittar på den här sidan på engelska eftersom vi inte har översatt den än. Hjälp oss att översätta detta innehåll.","translation-banner-body-update":"Det finns en ny version av den här sidan, men den finns bara på engelska just nu. Hjälp oss att översätta den senaste versionen.","translation-banner-button-join-translation-program":"Gå med i översättningsprogrammet","translation-banner-button-learn-more":"Lär dig mer","translation-banner-button-see-english":"Visa på engelska","translation-banner-button-translate-page":"Översätt sidan","translation-banner-title-new":"Hjälp till att översätta denna sida","translation-banner-title-update":"Hjälp till att uppdatera den här sidan","tutorials":"Handledningar","use":"Använd","use-ethereum":"Använda Ethereum","website-last-updated":"Webbplatsen senast uppdaterad","what-is-ether":"Vad är Ether (ETH)?","what-is-ethereum":"Vad är Ethereum?"},"routed":true,"originalPath":"/developers/tutorials/transfers-and-approval-of-erc-20-tokens-from-a-solidity-smart-contract/","redirect":false}}},
    "staticQueryHashes": ["1011117294","3003422828","4096231394"]}