{
    "componentChunkName": "component---src-templates-tutorial-js",
    "path": "/lt/developers/tutorials/transfers-and-approval-of-erc-20-tokens-from-a-solidity-smart-contract/",
    "result": {"data":{"siteData":{"siteMetadata":{"editContentUrl":"https://github.com/ethereum/ethereum-org-website/tree/dev/"}},"pageData":{"fields":{"slug":"/en/developers/tutorials/transfers-and-approval-of-erc-20-tokens-from-a-solidity-smart-contract/","readingTime":{"minutes":6.76}},"frontmatter":{"title":"Transfers and approval of ERC-20 tokens from a solidity smart contract","description":"How to use a smart contract to interact with a token using the Solidity language","lang":"en","tags":["smart contracts","tokens","solidity","getting started","erc-20"],"author":"jdourlens","source":"EthereumDev","sourceUrl":"https://ethereumdev.io/transfers-and-approval-or-erc20-tokens-from-a-solidity-smart-contract/","skill":"intermediate","published":"2020-04-07T00:00:00.000Z","sidebar":true,"sidebarDepth":null,"address":"0x19dE91Af973F404EDF5B4c093983a7c6E3EC8ccE","isOutdated":null},"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Transfers and approval of ERC-20 tokens from a solidity smart contract\",\n  \"description\": \"How to use a smart contract to interact with a token using the Solidity language\",\n  \"author\": \"jdourlens\",\n  \"tags\": [\"smart contracts\", \"tokens\", \"solidity\", \"getting started\", \"erc-20\"],\n  \"skill\": \"intermediate\",\n  \"lang\": \"en\",\n  \"sidebar\": true,\n  \"published\": \"2020-04-07T00:00:00.000Z\",\n  \"source\": \"EthereumDev\",\n  \"sourceUrl\": \"https://ethereumdev.io/transfers-and-approval-or-erc20-tokens-from-a-solidity-smart-contract/\",\n  \"address\": \"0x19dE91Af973F404EDF5B4c093983a7c6E3EC8ccE\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar Divider = makeShortcode(\"Divider\");\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"In the previous tutorial we studied \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/developers/tutorials/understand-the-erc-20-token-smart-contract/\"\n  }, \"the anatomy of an ERC-20 token in Solidity\"), \" on the Ethereum blockchain. In this article we\\u2019ll see how we can use a smart contract to interact with a token using the Solidity language.\"), mdx(\"p\", null, \"For this smart contract, we\\u2019ll create a really dummy decentralized exchange where a user can trade Ethereum with our newly deployed \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/developers/docs/standards/tokens/erc-20/\"\n  }, \"ERC-20 token\"), \".\"), mdx(\"p\", null, \"For this tutorial we\\u2019ll use the code we wrote in the previous tutorial as a base. Our DEX will instantiate an instance of the contract in its constructor and perform the operations of:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"exchanging tokens to ether\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"exchanging ether to tokens\")), mdx(\"p\", null, \"We\\u2019ll start our Decentralized exchange code by adding our simple ERC20 codebase:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"pragma solidity ^0.6.0;\\n\\ninterface IERC20 {\\n\\n    function totalSupply() external view returns (uint256);\\n    function balanceOf(address account) external view returns (uint256);\\n    function allowance(address owner, address spender) external view returns (uint256);\\n\\n    function transfer(address recipient, uint256 amount) external returns (bool);\\n    function approve(address spender, uint256 amount) external returns (bool);\\n    function transferFrom(address sender, address recipient, uint256 amount) external returns (bool);\\n\\n\\n    event Transfer(address indexed from, address indexed to, uint256 value);\\n    event Approval(address indexed owner, address indexed spender, uint256 value);\\n}\\n\\n\\ncontract ERC20Basic is IERC20 {\\n\\n    string public constant name = \\\"ERC20Basic\\\";\\n    string public constant symbol = \\\"ERC\\\";\\n    uint8 public constant decimals = 18;\\n\\n\\n    event Approval(address indexed tokenOwner, address indexed spender, uint tokens);\\n    event Transfer(address indexed from, address indexed to, uint tokens);\\n\\n\\n    mapping(address => uint256) balances;\\n\\n    mapping(address => mapping (address => uint256)) allowed;\\n\\n    uint256 totalSupply_ = 100 ether;\\n\\n    using SafeMath for uint256;\\n\\n   constructor(uint256 total) public {\\n    balances[msg.sender] = totalSupply_;\\n    }\\n\\n    function totalSupply() public override view returns (uint256) {\\n    return totalSupply_;\\n    }\\n\\n    function balanceOf(address tokenOwner) public override view returns (uint256) {\\n        return balances[tokenOwner];\\n    }\\n\\n    function transfer(address receiver, uint256 numTokens) public override returns (bool) {\\n        require(numTokens <= balances[msg.sender]);\\n        balances[msg.sender] = balances[msg.sender].sub(numTokens);\\n        balances[receiver] = balances[receiver].add(numTokens);\\n        emit Transfer(msg.sender, receiver, numTokens);\\n        return true;\\n    }\\n\\n    function approve(address delegate, uint256 numTokens) public override returns (bool) {\\n        allowed[msg.sender][delegate] = numTokens;\\n        emit Approval(msg.sender, delegate, numTokens);\\n        return true;\\n    }\\n\\n    function allowance(address owner, address delegate) public override view returns (uint) {\\n        return allowed[owner][delegate];\\n    }\\n\\n    function transferFrom(address owner, address buyer, uint256 numTokens) public override returns (bool) {\\n        require(numTokens <= balances[owner]);\\n        require(numTokens <= allowed[owner][msg.sender]);\\n\\n        balances[owner] = balances[owner].sub(numTokens);\\n        allowed[owner][msg.sender] = allowed[owner][msg.sender].sub(numTokens);\\n        balances[buyer] = balances[buyer].add(numTokens);\\n        emit Transfer(owner, buyer, numTokens);\\n        return true;\\n    }\\n}\\n\\nlibrary SafeMath {\\n    function sub(uint256 a, uint256 b) internal pure returns (uint256) {\\n      assert(b <= a);\\n      return a - b;\\n    }\\n\\n    function add(uint256 a, uint256 b) internal pure returns (uint256) {\\n      uint256 c = a + b;\\n      assert(c >= a);\\n      return c;\\n    }\\n}\\n\")), mdx(\"p\", null, \"Our new DEX smart contract will deploy the ERC-20 and get all the supplied:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"contract DEX {\\n\\n    IERC20 public token;\\n\\n    event Bought(uint256 amount);\\n    event Sold(uint256 amount);\\n\\n    constructor() public {\\n        token = new ERC20Basic();\\n    }\\n\\n    function buy() payable public {\\n        // TODO\\n    }\\n\\n    function sell(uint256 amount) public {\\n        // TODO\\n    }\\n\\n}\\n\")), mdx(\"p\", null, \"So we now have our DEX and it has all the token reserve available. The contract has two functions:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"buy\"), \": The user can send ether and get tokens in exchange\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"sell\"), \": The user can decide to send tokens to get ether back\")), mdx(\"h2\", {\n    \"id\": \"the-buy-function\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#the-buy-function\",\n    \"aria-label\": \"the buy function permalink\",\n    \"className\": \"header-anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"The buy function\"), mdx(\"p\", null, \"Let\\u2019s code the buy function. We\\u2019ll first need to check the amount of ether the message contains and verify that the contracts own enough tokens and that the message has some ether in it. If the contract owns enough tokens it\\u2019ll send the number of tokens to the user and emit the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Bought\"), \" event.\"), mdx(\"p\", null, \"Note that if we call the require function in the case of an error the ether sent will directly be reverted and given back to the user.\"), mdx(\"p\", null, \"To keep things simple, we just exchange 1 token for 1 Wei.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"function buy() payable public {\\n    uint256 amountTobuy = msg.value;\\n    uint256 dexBalance = token.balanceOf(address(this));\\n    require(amountTobuy > 0, \\\"You need to send some ether\\\");\\n    require(amountTobuy <= dexBalance, \\\"Not enough tokens in the reserve\\\");\\n    token.transfer(msg.sender, amountTobuy);\\n    emit Bought(amountTobuy);\\n}\\n\")), mdx(\"p\", null, \"In the case where the buy is successful we should see two events in the transaction: The token \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Transfer\"), \" and the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Bought\"), \" event.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1178px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/0789b512ac67511f04564aed1d2d3378/a13c9/transfer-and-bought-events.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"52.33333333333333%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA6UlEQVQoz4WS2w6CMBBE+f+vU5+MSkWgLb1Ab1xeHdkEVIgmQ5OSzp7daTNtbUxpGMcvjdNUc54zdi8ej7KEtDE+hNT3y5lMSOm83zVzIRqlcDqmCACpH4bVXFYV6uHo1iybhkq7EF6r951z8Z1ccd46tzVD8GAFamaCD27/QX7fbAWDEBJTV3WNCPApY9quo0mzH06SD/6W54fj6Xy53hhDlZX8w0ZNhZgwOaIB2bZtN89IY/4xhxjRp5CNMVYbq7Sm5PD/Zd6NagkcUtqwokDD4MOEFHE79DSy3RdCTgQDAQLRJVO5hfcEorI2ANOIwmkAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Two events in the transaction: Transfer and Bought\",\n    \"title\": \"Two events in the transaction: Transfer and Bought\",\n    \"src\": \"/static/0789b512ac67511f04564aed1d2d3378/a13c9/transfer-and-bought-events.png\",\n    \"srcSet\": [\"/static/0789b512ac67511f04564aed1d2d3378/5a46d/transfer-and-bought-events.png 300w\", \"/static/0789b512ac67511f04564aed1d2d3378/0a47e/transfer-and-bought-events.png 600w\", \"/static/0789b512ac67511f04564aed1d2d3378/a13c9/transfer-and-bought-events.png 1178w\"],\n    \"sizes\": \"(max-width: 1178px) 100vw, 1178px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(\"h2\", {\n    \"id\": \"the-sell-function\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#the-sell-function\",\n    \"aria-label\": \"the sell function permalink\",\n    \"className\": \"header-anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"The sell function\"), mdx(\"p\", null, \"The function responsible for the sell will first require the user to have approved the amount by calling the approve function beforehand. Then when the sell function is called, we\\u2019ll check if the transfer from the caller address to the contract address was successful and then send the Ethers back to the caller address.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"function sell(uint256 amount) public {\\n    require(amount > 0, \\\"You need to sell at least some tokens\\\");\\n    uint256 allowance = token.allowance(msg.sender, address(this));\\n    require(allowance >= amount, \\\"Check the token allowance\\\");\\n    token.transferFrom(msg.sender, address(this), amount);\\n    msg.sender.transfer(amount);\\n    emit Sold(amount);\\n}\\n\")), mdx(\"p\", null, \"If everything works you should see 2 events (a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Transfer\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Sold\"), \") in the transaction and your token balance and Ethereum balance updated.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1138px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/974fb2c5796514cc8789bc9e75560e67/05fb0/transfer-and-sold-events.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"49.66666666666666%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA8ElEQVQoz4WR226DMBBE+f/fa/vUBLAJ4Lu5w2OO6yqq0ohYI4TWOzuz46IWYpymdduesO27dY5b63wcBh+C9Z5viMOyrrmn4G5elv9kQJ1ubYyxLg7jNM9U/jYXzvuXyoA6BHQARvbjSNgP/kEihxgfNp6V13QwqoxRWimtgbEWCo6YW+QZJ3A+yKb5vlzLqrqUZVULmJhHsjhnrim4/da2H59f16oSUoqm8SHiP9k+Z+aEyAWrZD6M6VDJWbxX7pVCsJby1nZd3/daM4ld3uy8/ASGDjl1SvFEuM1R/6aNk5dMrvGJ29yXl8zP9ui5A2XwN2uPWaYDAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Two events in the transaction: Transfer and Sold\",\n    \"title\": \"Two events in the transaction: Transfer and Sold\",\n    \"src\": \"/static/974fb2c5796514cc8789bc9e75560e67/05fb0/transfer-and-sold-events.png\",\n    \"srcSet\": [\"/static/974fb2c5796514cc8789bc9e75560e67/5a46d/transfer-and-sold-events.png 300w\", \"/static/974fb2c5796514cc8789bc9e75560e67/0a47e/transfer-and-sold-events.png 600w\", \"/static/974fb2c5796514cc8789bc9e75560e67/05fb0/transfer-and-sold-events.png 1138w\"],\n    \"sizes\": \"(max-width: 1138px) 100vw, 1138px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \")), mdx(Divider, {\n    mdxType: \"Divider\"\n  }), mdx(\"p\", null, \"From this tutorial we saw how to check the balance and allowance of an ERC-20 token and also how to call \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Transfer\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"TransferFrom\"), \" of an ERC20 smart contract using the interface.\"), mdx(\"p\", null, \"Once you make a transaction we have a Javascript tutorial to \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://ethereumdev.io/waiting-for-a-transaction-to-be-mined-on-ethereum-with-js/\"\n  }, \"wait and get details about the transactions\"), \" that were made to your contract and a \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://ethereumdev.io/how-to-decode-event-logs-in-javascript-using-abi-decoder/\"\n  }, \"tutorial to decode events generated by token transfers or any other events\"), \" as long as you have the ABI.\"), mdx(\"p\", null, \"Here is the complete code for the tutorial:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-solidity\"\n  }, \"pragma solidity ^0.6.0;\\n\\ninterface IERC20 {\\n\\n    function totalSupply() external view returns (uint256);\\n    function balanceOf(address account) external view returns (uint256);\\n    function allowance(address owner, address spender) external view returns (uint256);\\n\\n    function transfer(address recipient, uint256 amount) external returns (bool);\\n    function approve(address spender, uint256 amount) external returns (bool);\\n    function transferFrom(address sender, address recipient, uint256 amount) external returns (bool);\\n\\n\\n    event Transfer(address indexed from, address indexed to, uint256 value);\\n    event Approval(address indexed owner, address indexed spender, uint256 value);\\n}\\n\\n\\ncontract ERC20Basic is IERC20 {\\n\\n    string public constant name = \\\"ERC20Basic\\\";\\n    string public constant symbol = \\\"ERC\\\";\\n    uint8 public constant decimals = 18;\\n\\n\\n    event Approval(address indexed tokenOwner, address indexed spender, uint tokens);\\n    event Transfer(address indexed from, address indexed to, uint tokens);\\n\\n\\n    mapping(address => uint256) balances;\\n\\n    mapping(address => mapping (address => uint256)) allowed;\\n\\n    uint256 totalSupply_ = 10 ether;\\n\\n    using SafeMath for uint256;\\n\\n   constructor() public {\\n    balances[msg.sender] = totalSupply_;\\n    }\\n\\n    function totalSupply() public override view returns (uint256) {\\n    return totalSupply_;\\n    }\\n\\n    function balanceOf(address tokenOwner) public override view returns (uint256) {\\n        return balances[tokenOwner];\\n    }\\n\\n    function transfer(address receiver, uint256 numTokens) public override returns (bool) {\\n        require(numTokens <= balances[msg.sender]);\\n        balances[msg.sender] = balances[msg.sender].sub(numTokens);\\n        balances[receiver] = balances[receiver].add(numTokens);\\n        emit Transfer(msg.sender, receiver, numTokens);\\n        return true;\\n    }\\n\\n    function approve(address delegate, uint256 numTokens) public override returns (bool) {\\n        allowed[msg.sender][delegate] = numTokens;\\n        emit Approval(msg.sender, delegate, numTokens);\\n        return true;\\n    }\\n\\n    function allowance(address owner, address delegate) public override view returns (uint) {\\n        return allowed[owner][delegate];\\n    }\\n\\n    function transferFrom(address owner, address buyer, uint256 numTokens) public override returns (bool) {\\n        require(numTokens <= balances[owner]);\\n        require(numTokens <= allowed[owner][msg.sender]);\\n\\n        balances[owner] = balances[owner].sub(numTokens);\\n        allowed[owner][msg.sender] = allowed[owner][msg.sender].sub(numTokens);\\n        balances[buyer] = balances[buyer].add(numTokens);\\n        emit Transfer(owner, buyer, numTokens);\\n        return true;\\n    }\\n}\\n\\nlibrary SafeMath {\\n    function sub(uint256 a, uint256 b) internal pure returns (uint256) {\\n      assert(b <= a);\\n      return a - b;\\n    }\\n\\n    function add(uint256 a, uint256 b) internal pure returns (uint256) {\\n      uint256 c = a + b;\\n      assert(c >= a);\\n      return c;\\n    }\\n}\\n\\ncontract DEX {\\n\\n    event Bought(uint256 amount);\\n    event Sold(uint256 amount);\\n\\n\\n    IERC20 public token;\\n\\n    constructor() public {\\n        token = new ERC20Basic();\\n    }\\n\\n    function buy() payable public {\\n        uint256 amountTobuy = msg.value;\\n        uint256 dexBalance = token.balanceOf(address(this));\\n        require(amountTobuy > 0, \\\"You need to send some ether\\\");\\n        require(amountTobuy <= dexBalance, \\\"Not enough tokens in the reserve\\\");\\n        token.transfer(msg.sender, amountTobuy);\\n        emit Bought(amountTobuy);\\n    }\\n\\n    function sell(uint256 amount) public {\\n        require(amount > 0, \\\"You need to sell at least some tokens\\\");\\n        uint256 allowance = token.allowance(msg.sender, address(this));\\n        require(allowance >= amount, \\\"Check the token allowance\\\");\\n        token.transferFrom(msg.sender, address(this), amount);\\n        msg.sender.transfer(amount);\\n        emit Sold(amount);\\n    }\\n\\n}\\n\")));\n}\n;\nMDXContent.isMDXComponent = true;","tableOfContents":{"items":[{"url":"#the-buy-function-the-buy-function","title":"The buy function {#the-buy-function}"},{"url":"#the-sell-function-the-sell-function","title":"The sell function {#the-sell-function}"}]}}},"pageContext":{"slug":"/lt/developers/tutorials/transfers-and-approval-of-erc-20-tokens-from-a-solidity-smart-contract/","ignoreTranslationBanner":false,"isOutdated":false,"isContentEnglish":true,"relativePath":"src/content/developers/tutorials/transfers-and-approval-of-erc-20-tokens-from-a-solidity-smart-contract/index.md","intl":{"language":"lt","defaultLanguage":"en","languages":["en","ar","bg","bn","ca","cs","de","el","es","fa","fi","fr","hi","hr","hu","id","ig","it","ja","ko","lt","ml","nl","nb","pl","pt","pt-br","ro","ru","se","sk","sl","tr","uk","vi","zh","zh-tw"],"messages":{"about-ethereum-org":"Apie ethereum.org","about-us":"Apie mus","brand-assets":"Prekės ženklo turtas","community":"Bendruomenė","contact":"Susisiekti","contributing":"Prisidėkite","cookie-policy":"Slapukų naudojimo politika","decentralized-applications-dapps":"Decentralizuotos programėlės (dapps'ai)","developers":"Kūrėjams","developers-home":"Kūrėjų pagrindinis puslapis","documentation":"Dokumentacija","ef-blog":"Ethereum fondo tinklaraštis","eips":"Pasiūlymai, kaip tobulinti Ethereum","enterprise":"Verslui","ethereum":"Ethereum","ethereum-2-0":"Ethereum 2.0","ethereum-brand-assets":"Ethereum prekės ženklo turtas","ethereum-community":"Ethereum bendruomenė","ethereum-glossary":"Ethereum žodynas","ethereum-wallets":"Ethereum piniginės","ethereum-whitepaper":"Ethereum baltoji knyga","get-eth":"Gauti ETH","get-started":"Pradėkite","guides-and-resources":"Vadovai ir ištekliai","how-ethereum-works":"Kaip Ethereum veikia","individuals":"Asmenims","individuals-menu":"Asmens meniu","language-support":"Kalbos palaikymas","languages":"Kalbos","learn":"Sužinoti","learn-by-coding":"Mokykitės kurdami kodus","learn-more":"Sužinoti daugiau","mainnet-ethereum":"Mainnet Ethereum","nav-beginners":"Pradedantiesiems","page-404-copy":"Norėdami rasti, ko ieškote, naudokite ieškos lauką, esantį viršuje, arba grįžkite į pradžią.","page-404-not-found":"Nerasta","page-enterprise":"Verslui","page-index":"Ethereum","page-index-section-beginners-item-one":"Esate naujokas Ethereum?","page-index-section-beginners-item-three":"Kodėl man tai turi rūpėti?","page-index-section-beginners-item-two":"Kas yra Ethereum?","page-index-section-beginners-title":"Pradedantiesiems","page-index-section-developers-item-one":"Darbo pradžios vadovai","page-index-section-developers-item-three":"Naujausi kūrėjo įrankiai","page-index-section-developers-item-two":"Išmokite programuoti išmaniąsias sutartis","page-index-section-developers-title":"Kūrėjams","page-index-section-enterprise-item-one":"Kodėl Ethereum verslui?","page-index-section-enterprise-item-three":"Verslo kūrėjų bendruomenė","page-index-section-enterprise-item-two":"Programos verslui funkcijos","page-index-section-enterprise-title":"Verslui","page-index-section-individuals-item-one":"Kas yra Ethereum?","page-index-section-individuals-item-three":"Vadovai ir ištekliai","page-index-section-individuals-item-two":"Naudoti Ethereum","page-index-section-individuals-title":"Asmenims","page-index-section-learn-item-one":"Ištekliai pradedantiesiems","page-index-section-learn-item-three":"ETH 2.0","page-index-section-use-item-one":"Ką galėčiau padaryti su Ethereum šiandien?","page-index-section-use-item-three":"Kas yra piniginė?","page-index-section-use-item-two":"Kaip gauti Ether?","page-index-section-use-title":"Naudoti","page-last-updated":"Puslapis paskutinį kartą atnaujintas","page-learning-tools-consensys-academy-description":"Ethereum kūrėjų naujokų kursai internetu","page-learning-tools-cryptozombies-description":"Išmokite Solidity, kurdami savo zombių žaidimą","page-learning-tools-ethernauts-description":"Įveikite lygius nulauždami išmaniąsias sutartis","privacy-policy":"Privatumo politika","private-ethereum":"Privatus Ethereum","search":"Paieška","set-up-local-env":"Susikurkite vietinę aplinką","stablecoins":"Stablecoins","terms-of-use":"Naudojimosi sąlygos","translation-banner-body-new":"Šį puslapį matote anglų kalba, nes jis dar nėra išverstas. Padėkite mums išversti šį turinį.","translation-banner-body-update":"Jau yra nauja šio puslapio versija, bet kol kas tik anglų kalba. Padėkite mums išversti naujausią versiją.","translation-banner-button-join-translation-program":"Prisijunkite prie vertimo programos","translation-banner-button-learn-more":"Sužinokite daugiau","translation-banner-button-see-english":"Rodyti anglų kalba","translation-banner-button-translate-page":"Išversti puslapį","translation-banner-title-new":"Pagalba verčiant šį puslapį","translation-banner-title-update":"Padėkite atnaujinti šį puslapį","tutorials":"Pamokos","use":"Naudoti","use-ethereum":"Naudokite Ethereum","website-last-updated":"Svetainė paskutinį kartą atnaujinta","what-is-ether":"Kas yra Ether (ETH)?","what-is-ethereum":"Kas yra Ethereum?","page-developer-meta-title":"Ethereum kūrėjų ištekliai","page-developers-about":"Apie šiuos kūrėjų išteklius","page-developers-about-desc":"ethereum.org sukurta tam, kad padėtų jums kurti Ethereum pasitelkiant dokumentus apie pamatinius principus bei kūrimo rinkinį. Be kita ko, čia yra ir vadovėlių, kurie padės pradžioje.","page-developers-about-desc-2":"Įkvėpti Mozilla Developer Network supratome, kad Ethereum turi turėti svarbios, kurėjams skirtos medžiagos ir išteklių saugyklą. Kaip ir pas mūsų bičiulius Mozilla naršyklėje, čia viskas pagrįsta atviru kodu ir paruošta plėtojimui ir tobulinimui.","page-developers-account-desc":"Kontaktai arba asmenys tinkle","page-developers-accounts-link":"Paskyros","page-developers-advanced":"Pažengusiems","page-developers-api-desc":"Bibliotekų naudojimas sąsajai su išmaniosiomis sutartimis","page-developers-api-link":"Backend programų sąsajos","page-developers-aria-label":"Kūrėjų meniu","page-developers-block-desc":"Į blokų grandinę įtraukti sandorių paketai","page-developers-block-explorers-desc":"Jūsų portalas į Ethereum duomenis","page-developers-block-explorers-link":"Blokų naršyklės","page-developers-blocks-link":"Blokai","page-developers-browse-tutorials":"Peržiūrėti vadovėlius","page-developers-choose-stack":"Pasirinkite savo rinkinį","page-developers-contribute":"Prisidėkite","page-developers-dev-env-desc":"IDE, pritaikytos dapps'ų kūrimui","page-developers-dev-env-link":"Kūrimo aplinkos","page-developers-discord":"Prisijungti prie Discord","page-developers-docs-introductions":"Įvadas","page-developers-evm-desc":"Sandorius apdorojantis kompiuteris","page-developers-evm-link":"EVM, Ethereum virtualusis įrenginys","page-developers-explore-documentation":"Nagrinėti dokumentus","page-developers-feedback":"Jei norite pateikti savo nuomonę, susisiekite su mumis per GitHub klausimų puslapį arba per mūsų Discord serverį.","page-developers-frameworks-desc":"Priemonės, paspartinančios kūrimo procesą","page-developers-frameworks-link":"Kūrimo struktūros","page-developers-fundamentals":"Pagrindai","page-developers-gas-desc":"Ether reikalingas sandorių vykdymui","page-developers-gas-link":"Dujos","page-developers-get-started":"Kaip norėtumėte pradėti?","page-developers-improve-ethereum":"Padėkite mums tobulinti ethereum.org","page-developers-improve-ethereum-desc":"Kaip ir ethereum.org, šie dokumentai yra sukurti bendruomenės. Sukurkite PR, jei randate klaidų, tobulintinų sričių ar naujų galimybių padėti Ethereum kūrėjams.","page-developers-into-eth-desc":"Įžanga į blokų grandines ir Ethereum","page-developers-intro-dapps-desc":"Įžanga į decentralizuotas programas","page-developers-intro-dapps-link":"Įžanga į dapps'us (decentralizuotas programas)","page-developers-intro-eth-link":"Įžanga į Ethereum","page-developers-intro-stack":"Įžanga į rinkinį","page-developers-intro-stack-desc":"Įžanga į Ethereum rinkinį","page-developers-js-libraries-desc":"Javascript naudojimas sąsajai su išmaniosiomis sutartimis","page-developers-js-libraries-link":"Javascript bibliotekos","page-developers-language-desc":"Ethereum naudojimas su pažįstamomis kalbomis","page-developers-languages":"Programavimo kalbos","page-developers-learn":"Išmokite kurti Ethereum","page-developers-learn-desc":"Sužinokite apie pagrindines sąvokas ir Ethereum rinkinį skaitydami mūsų dokumentus","page-developers-learn-tutorials":"Mokykitės iš vadovėlių","page-developers-learn-tutorials-cta":"Peržiūrėkite vadovėlius","page-developers-learn-tutorials-desc":"Išmokite, kaip kurti Ethereum žingsnis po žingsnio iš kūrėjų, kurie tai jau yra darę.","page-developers-meta-desc":"Dokumentai, vadovai ir įrankiai kūrėjams, kuriantiems Ethereum tinkle.","page-developers-mining-desc":"Kaip kuriami nauji blokai ir siekiama susitarimo","page-developers-mining-link":"Kasyba","page-developers-networks-desc":"Pagrindinio tinklo ir bandomųjų tinklų apžvalga","page-developers-networks-link":"Tinklai","page-developers-node-clients-desc":"Kaip blokai ir sandoriai tikrinami tinkle","page-developers-node-clients-link":" Mazgai ir klientai","page-developers-oracle-desc":"Netinklinių duomenų įtraukimas į išmaniąsias sutartis","page-developers-oracles-link":"Orakulai","page-developers-play-code":"Žaisti su kodu","page-developers-read-docs":"Skaityti dokumentus","page-developers-scaling-desc":"Sprendimai greitesniems sandoriams","page-developers-scaling-link":"Dydžio pritaikymas","page-developers-smart-contract-security-desc":"Saugumo priemonės, į kurias reikia atsižvelgti kuriant","page-developers-smart-contract-security-link":"Saugumas","page-developers-set-up":"Susikurkite vietinę aplinką","page-developers-setup-desc":"Paruoškite savo rinkinį kūrimui, sukonfigūruodami kūrimo aplinką.","page-developers-smart-contracts-desc":"Decentralizuotų programų logika- save vykdančios sutartys","page-developers-smart-contracts-link":"Išmaniosios sutartys","page-developers-stack":"Rinkinys","page-developers-start":"Pradėti bandyti","page-developers-start-desc":"Norite pirma išbandyti, o po to klausti?","page-developers-storage-desc":"Kaip saugoti decentralizuotas programas","page-developers-storage-link":"Saugykla","page-developers-subtitle":"Kūrėjų Ethereum vadovas. Sukurta kūrėjų kūrėjams.","page-developers-title-1":"Ethereum","page-developers-title-2":"kūrėjas","page-developers-title-3":"ištekliai","page-developers-token-standards-desc":"Priimtų žetonų standartų apžvalga","page-developers-token-standards-link":"Žetonų standartai","page-developers-transactions-desc":"Kaip keičiasi Ethereum būsena","page-developers-transactions-link":"Sandoriai","page-developers-web3-desc":"Kuo skiriasi web3 kūrimo pasaulis","page-developers-web3-link":"Web2 ir Web3 palyginimas","page-index-hero-image-alt":"ethereum.org herojaus vaizdas","page-index-meta-description":"Ethereum yra globali, decentralizuota pinigų platforma, skirta naujo tipo programoms. Ethereum platformoje galite sukurti pinigus valdantį kodą bei kurti programas, prieinamas visame pasaulyje.","page-index-meta-title":"Pagrindinis puslapis","page-index-sections-developers-desc":"Sužinokite, kokia technologija pagrįstas Ethereum bei jo programos, kad patys galėtumėte pradėti kurti platformoje.","page-index-sections-developers-image-alt":"Paveikslėlis rankos, kuri iš lego kaladėlių renka Ethereum simbolį","page-index-sections-developers-link-text":"Pradėkite kurti","page-index-sections-developers-title":"Kūrėjams","page-index-sections-enterprise-desc":"Pamatykite, kaip Ethereum atveria naujus verslo modelius, sumažina išlaidas ir užtikrina verslo ateities perspektyvas.","page-index-sections-enterprise-image-alt":"Paveiklėlis grupės, dirbančios su Ethereum projektu prie nešiojamojo kompiuterio","page-index-sections-enterprise-link-text":"Ethereum verslui","page-index-sections-enterprise-title":"Verslui","page-index-sections-individuals-desc":"Susipažinkite su Ethereum, Ether, piniginėmis, žetonais ir kt., kad galėtumėte pradėti naudoti Ethereum programas.","page-index-sections-individuals-image-alt":"Paveikslėlis šuns, sėdinčio prie kompiuterio","page-index-sections-individuals-link-text":"Pradėkite dirbti su Ethereum","page-index-sections-individuals-title":"Apie Ethereum","page-index-subtitle":"Ethereum platformoje galite kurti kodą, kontroliuojantį skaitmenines reikšmes, veikiantį tiksliai kaip suprogramavote, ir pasiekiamą visame pasaulyje.","page-index-title":"Ethereum yra globali, atviro kodo platforma decentralizuotoms programoms kurti."},"routed":true,"originalPath":"/developers/tutorials/transfers-and-approval-of-erc-20-tokens-from-a-solidity-smart-contract/","redirect":false}}},
    "staticQueryHashes": ["1011117294","3003422828","4096231394"]}